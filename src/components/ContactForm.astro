---
// ContactForm Component - Professional contact form with Netlify integration
---

<div class="victorian-frame bg-mahogany/30 p-8">
  <h3 class="text-2xl font-cyber gradient-text mb-6 text-center">
    Send us a Message
  </h3>

  <form
    action="https://api.web3forms.com/submit"
    method="POST"
    class="space-y-6"
    id="contact-form"
  >
    <!-- Web3Forms Access Key -->
    <input
      type="hidden"
      name="access_key"
      value="db5f2a1d-22b0-446f-a71b-0cd8f3f4436a"
    />

    <!-- Optional: Redirect to a thank you page after submission -->
    <input
      type="hidden"
      name="redirect"
      value="https://localaifinance.com/contact?success=true"
    />

    <!-- Optional: Subject line for the email -->
    <input
      type="hidden"
      name="from_name"
      value="LocalAI Finance Contact Form"
    />

    <!-- Honeypot Spam Protection (Web3Forms compatible) -->
    <input
      type="checkbox"
      name="botcheck"
      class="hidden"
      style="display: none;"
    />

    <!-- Optional: Customize email subject -->
    <input
      type="hidden"
      name="subject"
      value="New Contact Form Submission from LocalAI Finance"
    />

    <!-- Name and Email Row -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label for="name" class="block text-sm font-victorian brass-text mb-2">
          Full Name <span class="text-neon-pink">*</span>
        </label>
        <input
          type="text"
          id="name"
          name="name"
          required
          class="w-full px-4 py-3 bg-charcoal border-2 border-brass/30 text-parchment rounded-lg focus:ring-2 focus:ring-electric focus:border-electric transition-all duration-200"
          placeholder="Enter your full name"
        />
      </div>

      <div>
        <label for="email" class="block text-sm font-victorian brass-text mb-2">
          Email Address <span class="text-neon-pink">*</span>
        </label>
        <input
          type="email"
          id="email"
          name="email"
          required
          class="w-full px-4 py-3 bg-charcoal border-2 border-brass/30 text-parchment rounded-lg focus:ring-2 focus:ring-electric focus:border-electric transition-all duration-200"
          placeholder="Enter your email address"
        />
      </div>
    </div>

    <!-- Company and Subject Row -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label
          for="company"
          class="block text-sm font-victorian brass-text mb-2"
        >
          Company (Optional)
        </label>
        <input
          type="text"
          id="company"
          name="company"
          class="w-full px-4 py-3 bg-charcoal border-2 border-brass/30 text-parchment rounded-lg focus:ring-2 focus:ring-electric focus:border-electric transition-all duration-200"
          placeholder="Your company name"
        />
      </div>

      <div>
        <label
          for="subject"
          class="block text-sm font-victorian brass-text mb-2"
        >
          Subject <span class="text-neon-pink">*</span>
        </label>
        <select
          id="subject"
          name="subject"
          required
          class="w-full px-4 py-3 bg-charcoal border-2 border-brass/30 text-parchment rounded-lg focus:ring-2 focus:ring-electric focus:border-electric transition-all duration-200"
        >
          <option value="">Select a subject</option>
          <option value="General Inquiry">General Inquiry</option>
          <option value="Technical Support">Technical Support</option>
          <option value="Business Partnership">Business Partnership</option>
          <option value="Media & Press">Media & Press</option>
          <option value="Feature Request">Feature Request</option>
          <option value="Bug Report">Bug Report</option>
          <option value="Other">Other</option>
        </select>
      </div>
    </div>

    <!-- Message -->
    <div>
      <label for="message" class="block text-sm font-victorian brass-text mb-2">
        Message <span class="text-neon-pink">*</span>
      </label>
      <textarea
        id="message"
        name="message"
        required
        rows="6"
        class="w-full px-4 py-3 bg-charcoal border-2 border-brass/30 text-parchment rounded-lg focus:ring-2 focus:ring-electric focus:border-electric transition-all duration-200 resize-vertical"
        placeholder="Tell us about your inquiry, question, or how we can help you..."
      ></textarea>
      <p class="text-sm text-parchment/50 font-serif mt-2">
        Please provide as much detail as possible to help us assist you better.
      </p>
    </div>

    <!-- Privacy Notice -->
    <div class="bg-matrix/10 border-2 border-matrix/30 rounded-lg p-4">
      <div class="flex items-start">
        <svg
          class="w-5 h-5 text-matrix mt-0.5 mr-3 flex-shrink-0"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
          ></path>
        </svg>
        <div>
          <h4 class="text-sm font-victorian brass-text">Privacy Notice</h4>
          <p class="text-sm text-parchment/70 font-serif mt-1">
            Your information is processed locally and securely. We never share
            your data with third parties. By submitting this form, you agree to
            our <a
              href="/privacy"
              class="text-electric hover:text-brass underline hover:no-underline"
              >Privacy Policy</a
            >.
          </p>
        </div>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="text-center">
      <button
        type="submit"
        class="btn-primary inline-flex items-center px-8 py-3 shadow-brass"
      >
        <svg
          class="w-5 h-5 mr-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
        </svg>
        Send Message
      </button>
    </div>

    <!-- Success Message (Hidden by default) -->
    <div
      id="form-success"
      class="hidden bg-matrix/10 border-2 border-matrix/50 rounded-lg p-4 text-center shadow-neon-green"
    >
      <svg
        class="w-6 h-6 text-matrix mx-auto mb-2"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <h4 class="brass-text font-victorian">Message sent successfully!</h4>
      <p class="text-parchment/70 font-serif text-sm mt-1">
        Thank you for contacting us. We'll get back to you soon.
      </p>
    </div>
  </form>
</div>

<script>
  // Handle Web3Forms submission
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("contact-form") as HTMLFormElement;
    const successMessage = document.getElementById("form-success");
    const submitButton = form?.querySelector(
      'button[type="submit"]'
    ) as HTMLButtonElement;

    if (form && successMessage) {
      form.addEventListener("submit", async function (e) {
        e.preventDefault();

        // Disable submit button and show loading state
        if (submitButton) {
          submitButton.disabled = true;
          submitButton.innerHTML = `
            <svg class="animate-spin h-5 w-5 mr-2 inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Sending...
          `;
        }

        // Get form data
        const formData = new FormData(form);

        try {
          // Convert FormData to JSON object
          const object = {};
          formData.forEach((value, key) => {
            object[key] = value;
          });
          const json = JSON.stringify(object);

          console.log("Submitting form to Web3Forms...");
          console.log("Form data:", object);

          // Submit to Web3Forms as JSON
          const response = await fetch("https://api.web3forms.com/submit", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Accept: "application/json",
            },
            body: json,
          });

          console.log("Response status:", response.status);
          console.log("Response OK:", response.ok);

          const data = await response.json();
          console.log("Response data:", data);

          if (data.success) {
            // Show success message
            form.style.display = "none";
            successMessage.classList.remove("hidden");

            // Optional: Reset form after 5 seconds
            setTimeout(() => {
              form.reset();
            }, 5000);
          } else {
            // Show error
            alert(
              "Oops! Something went wrong. Please try again or email us directly at info@localaifinance.com"
            );

            // Re-enable button
            if (submitButton) {
              submitButton.disabled = false;
              submitButton.innerHTML = `
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                </svg>
                Send Message
              `;
            }
          }
        } catch (error) {
          console.error("Form submission error:", error);
          console.error("Error type:", error.name);
          console.error("Error message:", error.message);

          alert("Network error. Please check your connection and try again.");

          // Re-enable button
          if (submitButton) {
            submitButton.disabled = false;
            submitButton.innerHTML = `
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
              </svg>
              Send Message
            `;
          }
        }
      });
    }
  });
</script>
